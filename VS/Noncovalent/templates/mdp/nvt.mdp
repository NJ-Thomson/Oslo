; NVT equilibration - {{STAGE}} stage, lambda {{STATE}}

;----------------------------------------------------
; RUN CONTROL
;----------------------------------------------------
define       = -DPOSRES
integrator   = sd
nsteps       = 25000         ; 100 ps
dt           = 0.004
comm-mode    = Linear
nstcomm      = 50

;----------------------------------------------------
; OUTPUT CONTROL
;----------------------------------------------------
nstxout                = 25000
nstvout                = 0
nstfout                = 0
nstxout-compressed     = 500
compressed-x-precision = 1000
nstlog                 = 500
nstenergy              = 500
nstcalcenergy          = 50

;----------------------------------------------------
; BONDS
;----------------------------------------------------
constraint_algorithm   = lincs
constraints            = all-bonds
lincs-iter             = 1
lincs-order            = 6
lincs-warnangle        = 30
continuation           = no

;----------------------------------------------------
; NEIGHBOR SEARCHING
;----------------------------------------------------
cutoff-scheme       = Verlet
ns-type             = grid
nstlist             = 10
rlist               = 1.2
pbc                 = xyz

;----------------------------------------------------
; ELECTROSTATICS
;----------------------------------------------------
coulombtype      = PME
rcoulomb         = 1.0
ewald_geometry   = 3d
pme-order        = 4
fourierspacing   = 0.10
ewald-rtol       = 1e-6

;----------------------------------------------------
; VDW
;----------------------------------------------------
vdwtype                 = Cut-off
vdw-modifier            = Potential-shift-Verlet
verlet-buffer-tolerance = 0.005
rvdw                    = 1.0
DispCorr                = EnerPres

;----------------------------------------------------
; TEMPERATURE COUPLING (SD ==> Langevin dynamics)
;----------------------------------------------------
tc-grps    = System
tau-t      = 2.0
ref-t      = {{TEMPERATURE}}

;----------------------------------------------------
; PRESSURE COUPLING
;----------------------------------------------------
pcoupl     = no

;----------------------------------------------------
; VELOCITY GENERATION
;----------------------------------------------------
gen-vel      = yes
gen-seed     = -1
gen-temp     = {{TEMPERATURE}}

;----------------------------------------------------
; FREE ENERGY
;----------------------------------------------------
free-energy              = yes
couple-moltype           = {{LIGAND_MOLTYPE}}
couple-lambda0           = {{COUPLE_LAMBDA0}}
couple-lambda1           = {{COUPLE_LAMBDA1}}
sc-alpha                 = 0.5
sc-power                 = 1
sc-sigma                 = 0.3
init-lambda-state        = {{STATE}}
{{LAMBDA_VECTORS}}
nstdhdl                  = 100
dhdl-print-energy        = total
calc-lambda-neighbors    = -1
separate-dhdl-file       = yes
couple-intramol          = yes
